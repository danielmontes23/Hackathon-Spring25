---
import Layout from '../layouts/Layout.astro';
import '../styles/Global.css';
import DynamicResumeSections from '../components/DynamicResumeSections.jsx';
---

<Layout>
  <main style="max-width: 700px; margin: 2rem auto;">
    <h1>Build your Resume</h1>
    <form id="resume-form">
      <section>
        <h2>Personal Info</h2>
        <label>
          First Name:
          <input type="text" name="first_name" id="first_name" required />
        </label>
        <label>
          Last Name:
          <input type="text" name="last_name" id="last_name" required />
        </label>
        <label>
          Email:
          <input type="email" name="email" id="email" required />
        </label>
        <label>
          Phone:
          <input type="tel" name="phone" id="phone" />
        </label>
      </section>

      <!-- Only this part is React! -->
      <DynamicResumeSections client:load />

      <button type="submit">Generate Resume</button>
    </form>
    <script>
      // Persist personal info fields using localStorage
      document.addEventListener('DOMContentLoaded', () => {
        const fields = ['first_name', 'last_name', 'email', 'phone'];
        fields.forEach(field => {
          const input = document.getElementById(field);
          if (input && localStorage.getItem(field)) {
            input.value = localStorage.getItem(field);
          }
          if (input) {
            input.addEventListener('input', () => {
              localStorage.setItem(field, input.value);
            });
          }
        });
      });
    </script>
  </main>
</Layout>
